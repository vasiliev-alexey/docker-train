##            Основы Docker


#### Компоненты Docker
1. Daemon - процесс в операционной системе котрый используя библиотеку libcontainer   и функции ядра Linux cgroups и namespaces заставляет работать.
2. Client - клиентская часть, которая взаимодействует с Daemon по протоколу  https, может быть написана на любом языке используя интерфейсы (коннекторы)
3. Registry - реестр образов для Docker

#### Технологиии поддержки предоставляемые Docker
1. Swarm - решение для кластеризации
2. Docker Compose - решение для объединения узлов для одного приложения
3. Docker Machine - решение для создания узлов на локальных и удаленных ресурсках
4. Kitematic - GUI Для Windows и Mac
5. Docker Trusted Registry = локальный  реестр


#### Как создаются образы
Для создания образа используется команда build
> docker build <Dockerfile> <Контекст>

<Dockerfile> - указывается имя файла, или путь к нему или STDIN
<Контекст> - может быть пустым,
  * . - текущая диретория
  * абсольтгый или относительный пусть к диретории
  * URL
  * git репозитрии

Образ строится на "луковой архитектуре"
Для получения списка слоев используется опция history

#### Инструкции в Dockerfile
* ADD - добавляет файлы из контекста, может добавлять из архива (файлы будут автоматически распакованы) или по URL. Множественное присутсвие
* CMD - выполняет заданную инструкцию во время инициализации контейнера, может быть указан несколько раз, но будет выполнена тоьлко последняя.
* COPY - копирует файлы из исходной среды в создавемый контейнер. имеет 2 формата source target и ["source", "target"]
* ENTRYPOINT - определяет выполнемый файл и параметры , выполнемую при инициализации контейнера. Обычно скрипт, выставлющий окружение и запускающий основную програму.
* ENV- определет переменный среды внутри создавемого контейнера.
* EXPOSE  - сообщает среде докер, что контейнер будет прослушивать или использовать определенные порты в сетевой инфраструктуре. Используется для установления сетевой инфраструктуры между контйнерами
* FROM - задает базовый образ для создавемого контейнера в формате IMAGE:TAG
* MAINTAINER -  автор создавемого контейнера
* ONBUILD - задавет инструкцию, которая будет выполнена, если данный образ станет базовым, и будет выполнен в момент создания  дочернего образа
* RUN  - запусакет данную инструкцию внутри контйнера и сохранет результат
* USER - задает UID пользователя, с правами которого будут выполнятя комманды RUN CMD  ADD. UID един для хоста и контенйнера, имена могут отличатся.
* VOLUME - объявляет заданый каталог или файл хоста как том.
* WORKDIR - объявляет рабочий каталог для последующих инструкций.

#### Установление свзи с внешним миром
Для установления сетвого взаимодействия необходимо открыть порты с помощью параметров -p  или -P
  -p  принмает доп аргументом мапинг порта хоста и контенера - например 8000:80
  -P  хост выдает контейнеру, первый свободный порт
Для установления какие порты открыты для контейнера используется комманда port
docker port
